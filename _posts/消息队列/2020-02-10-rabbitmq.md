---
layout: post
title: "RabbitMQ"
date: 2020-02-10 13:54:46
description: "RabbitMQ"
categories:
- 消息队列
permalink: rabbitmq
---

##### 安装
###### 安装Erlang
###### RabbitMQ的安装
官网下载地址[rabbitmq-server-generic-unix-3.8.2.tar.xz](https://github.com/rabbitmq/rabbitmq-server/releases/download/v3.8.2/rabbitmq-server-generic-unix-3.8.2.tar.xz)  
将RabbitMQ安装到与Erlang同一个目录(/opt)下面

```
cd /opt
tar zxvf rabbitmq-server-generic-unix-3.8.2.tar.xz
mv rabbitmq-server-3.8.2 rabbitmq
```

修改/etc/profile文件
```
export RABBITMQ_HOME=/opt/rabbitmq;
export PATH=$PATH:$RABBITMQ_HOME/sbin;
```
之后执行 `source /etc/profile` 命令让配置文件生效

##### 运行

```
# 守护进程方式在后台运行
rabbitmq-server start &

# 查看状态
rabbitmqctl status

# 停用
rabbitmqctl stop

# 添加新用户，用户名为root，密码为111111
rabbitmqctl add_user root 111111

# 为root用户设置所有权限
rabbitmqctl set_permissions -p / root ".*" ".*" ".*"

# 设置root用户为管理员
rabbitmqctl set_user_tags administrator

# 启用管控台
rabbitmq-plugins enable rabbitmq_management

# 浏览器访问 http://localhost:15672
```

##### RabbitMQ用户角色
* `node`
  > 不能访问 management plugin  

* `management`
  > 用户可以通过AMQP做的任何事外加
  > 列出自己可以通过AMQP登入的virtual hosts  
  > 查看自己的virtual hosts中的queues, exchanges 和 bindings  
  > 查看和关闭自己的channels 和 connections  
  > 查看有关自己的virtual hosts的“全局”的统计信息，包含其他用户在这些virtual hosts中的活动  

* `policymaker`  
  > management可以做的任何事外加  
  > 查看、创建和删除自己的virtual hosts所属的policies和parameters

* `monitoring`  
  > management可以做的任何事外加  
  > 列出所有virtual hosts，包括他们不能登录的virtual hosts  
  > 查看其他用户的connections和channels  
  > 查看节点级别的数据如clustering和memory使用情况  
  > 查看真正的关于所有virtual hosts的全局的统计信息  

* `administrator`  
 > policymaker和monitoring可以做的任何事外加  
 > 创建和删除virtual hosts  
 > 查看、创建和删除users  
 > 查看创建和删除permissions  
 > 关闭其他用户的connections  
